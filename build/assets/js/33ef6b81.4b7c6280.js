"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[4637],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(96540);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}},64432:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>m,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"guides/collecting-card-information","title":"Collecting Cards","description":"Topics covered on this page","source":"@site/docs/guides/collecting-card-information.md","sourceDirName":"guides","slug":"/guides/collecting-card-information","permalink":"/guides/collecting-card-information","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Capture","permalink":"/"},"next":{"title":"Merchant-Presented Mode (C scan B)","permalink":"/payment methods/AliPay + Offline/alipayplus-mpm"}}');var s=t(74848),r=t(28453);const a={},o="Collecting Cards",d={},c=[{value:"Omise Token Simulator",id:"omise-token-simulator",level:2},{value:"A Full-Fledged Example",id:"a-full-fledged-example",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"collecting-cards",children:"Collecting Cards"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:(0,s.jsx)("em",{children:"Topics covered on this page"})}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#a-full-fledged-example",children:"A full-fledged example"})}),"\n"]})]}),"\n",(0,s.jsx)(n.p,{children:"!This article will help you build a form that will let you collect cards directly from a page on your website and tokenize them."}),"\n",(0,s.jsx)(n.p,{children:"Omise.js allows you to collect card information easily. Omise.js is a client-side JavaScript library that lets you have your own HTML form running on your customer's browser. It can send sensitive card data to the Omise server and get a card token in exchange. The token can then be forwarded to your server for processing. Your server never has to deal with sensitive card information."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Note that the only way to send card data to Omise is via JavaScript using Omise.js. Unless you have a PCI-DSS license to send server side."})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"small_token",src:t(70864).A+"",width:"1500",height:"1500"})}),"\n",(0,s.jsx)(n.p,{children:"On a high level, this is how it works:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Using Omise.js and your public key, send the cardholder data from your customer's browser to Omise,"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Omise tokens service responds with a single-use card token,"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Forward the token back to your server,"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Use this token to take an action on the card. You can ",(0,s.jsx)(n.a,{href:"/charges-api#create-a-charge",children:"charge the card"}),", ",(0,s.jsx)(n.a,{href:"/customers-api#create-a-customer",children:"save the card on a new customer"}),", or ",(0,s.jsx)(n.a,{href:"/customers-api#update-a-customer",children:"attach the card to an existing one"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Please note that we recommend against storing that token. Since it is for one-time use only, there is no point in saving it for later use. It's generally a good practice to use and forget about it immediately."})}),"\n",(0,s.jsx)(n.h2,{id:"omise-token-simulator",children:"Omise Token Simulator"}),"\n",(0,s.jsx)("div",{className:"card-block",children:(0,s.jsxs)("form",{action:"/checkout",method:"post",id:"checkout",className:"card-form","data-gtm-form-interact-id":"0",style:{opacity:1},children:[(0,s.jsx)("input",{type:"hidden",name:"omise_token"}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("label",{children:"Name"}),(0,s.jsx)("input",{type:"text","data-omise":"holder_name",value:"BUMBIN ARAUPORN","data-gtm-form-interact-field-id":"0"})]}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("label",{children:"Number"}),(0,s.jsx)("input",{type:"text","data-omise":"number",value:"4242424242424242"})]}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("label",{children:"Date"}),(0,s.jsx)("input",{type:"text","data-omise":"expiration_month",size:"4",value:"02"}),(0,s.jsx)("input",{type:"text","data-omise":"expiration_year",size:"8",value:"2022"})]}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("label",{children:"CVC"}),(0,s.jsx)("input",{type:"text","data-omise":"security_code",size:"8",value:"111"})]}),(0,s.jsx)("div",{className:"row card-form-submit-row ",children:(0,s.jsx)("input",{type:"submit",id:"create_token",style:{marginTop:"16px"},value:"Generate Token",className:"PrimaryButton",disabled:!0})})]})}),"\n",(0,s.jsx)(n.p,{children:"Generated Token: ..."}),"\n",(0,s.jsxs)(n.p,{children:["You can learn more about the tokens API in the ",(0,s.jsx)(n.a,{href:"/tokens-api",children:"tokens reference"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"a-full-fledged-example",children:"A Full-Fledged Example"}),"\n",(0,s.jsxs)(n.p,{children:["First, you need to insert Omise.js into your webpage. Add it before the closing ",(0,s.jsx)(n.code,{children:"</body>"})," tag:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<script src="https://cdn.omise.co/omise.js"><\/script>\n'})}),"\n",(0,s.jsx)(n.p,{children:"For example, the Omise JS library doesn't need jQuery, but we'll use it as a convenient way to access the DOM. Add the jQuery library to the page with:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<script src="http://code.jquery.com/jquery-1.12.1.min.js"><\/script>\n'})}),"\n",(0,s.jsx)(n.p,{children:"Then add your public key to let Omise.js authenticate against Omise API:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'<script>\n  Omise.setPublicKey("pkey_test_4xpip92iqmehclz4a4d");\n<\/script>\n'})}),"\n",(0,s.jsx)(n.p,{children:"Next, you need a form that will collect the card details."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'\n<form action="/checkout" method="post" id="checkout">\n  <div id="token_errors"></div>\n\n  <input type="hidden" name="omise_token">\n\n  <div>\n    Name<br>\n    <input type="text" data-omise="holder_name">\n  </div>\n  <div>\n    Number<br>\n    <input type="text" data-omise="number">\n  </div>\n  <div>\n    Date<br>\n    <input type="text" data-omise="expiration_month" size="4"> /\n    <input type="text" data-omise="expiration_year" size="8">\n  </div>\n  <div>\n    Security Code<br>\n    <input type="text" data-omise="security_code" size="8">\n  </div>\n\n  <input type="submit" id="create_token">\n</form>\n\n\n'})}),"\n",(0,s.jsx)(n.p,{children:"Next, we need to trigger the creation of the token when the submit button is pressed. Then, fill in the token field and clear the other fields so they are not submitted to your server."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'\n$("#checkout").submit(function () {\n\n  var form = $(this);\n\n  // Disable the submit button to avoid repeated clicks.\n  form.find("input[type=submit]").prop("disabled", true);\n\n  // Serialize the form fields into a valid card object.\n  var card = {\n    "name": form.find("[data-omise=holder_name]").val(),\n    "number": form.find("[data-omise=number]").val(),\n    "expiration_month": form.find("[data-omise=expiration_month]").val(),\n    "expiration_year": form.find("[data-omise=expiration_year]").val(),\n    "security_code": form.find("[data-omise=security_code]").val()\n  };\n\n  // Send a request to create a token, then trigger the callback function once\n  // a response is received from Omise.\n  //\n  // Note that the response could be an error, and this needs to be handled within\n  // the callback.\n  Omise.createToken("card", card, function (statusCode, response) {\n    if (response.object == "error" || !response.card.security_code_check) {\n      // Display an error message.\n      var message_text = "SET YOUR SECURITY CODE CHECK FAILED MESSAGE";\n      if(response.object == "error") {\n        message_text = response.message;\n      }\n      $("#token_errors").html(message_text);\n\n      // Re-enable the submit button.\n      form.find("input[type=submit]").prop("disabled", false);\n    } else {\n      // Then fill the omise_token.\n      form.find("[name=omise_token]").val(response.id);\n\n      // Remove card number from the form before submitting to server.\n      form.find("[data-omise=number]").val("");\n      form.find("[data-omise=security_code]").val("");\n\n      //Submit the token to the server.\n      form.get(0).submit();\n    };\n  });\n\n  // Prevent the form from being submitted;\n  return false;\n\n});\n\n'})}),"\n",(0,s.jsx)(n.p,{children:"That's it! Omise can start collecting credit card information, and you'll receive a token in return, which you can use to take action on the card."})]})}function m(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},70864:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/small_token@2x-e1e1db4dbfeb0df97dc5e4dd5e238048.jpg"}}]);